* 階層性のあるおデータに対する回帰分析
	* 学習者 ( Level1 ) と学習者が所属する学校 ( Level2 )など
* 群ごとの回帰分析はふさわしくない
	* 全体で持っている情報を失ってしまう
	* 全体の情報を保持しつつ、群ごとの情報 を得ることが出来る方法が必要
	* 同じ群に属する人たちは似ていてデータが独立しているとは考えにくい

# 言葉の定義
### 下記のものは基本的にすべて同じもの
* マルチレベルモデル ( multilevel model/analysis )
* 階層線形モデル ( hierarchical linear model: HLM )
* 線形混合モデル ( linear mixed model )
* 混合効果モデル ( mixed-effect model )
* ランダム効果/係数/回帰モデル  ( random effects/coefﬁcient/regression model )
* 成長曲線モデル ( growth curve model ) 

# モデルの分類、
### 一般線形モデル General Linear Model
* これまでの分析方法
	* t検定
	* 分散分析
	* 重回帰分析

### 一般化線形モデル Generalized Linear Model

### 一般化線形混合モデル Generalized Linear Mixed Model
* 特に、変量効果 ( random eﬀect ) を扱う場合

# 固定効果と変量効果
## 固定効果 ( ﬁxed effect ) 
* これまでの分析方法と同じもの
* 全体から1つの値を推定
* ある要因で測定している水準以外で調べるべきものはない

## 変量効果 ( random effect ) 
* レベル2の集団ごとに値を推定
* ある要因で測定している水準は全体からサンプリングされたもの
	* 他にも見るべきものがある
* Level 2  ( 学校 ) がランダム ( 変量効果 )  
	* どの学校がサンプリングされるかはわからない
	* でも、結果は一般化したい

## 混合効果
* Mixed effect = Random effects + Fixed effects

# 数式
## Level1
$yij = b_{0j}+ b_{1j}X_{1ij} + e_{ij}$

## Level2
* b= γ+ u0jLevel 2 (j) b= γ+ u1jLevel 1 (i) yij = b+ b1jx1ij + eij
「見習い編」って... たしか言ってたよね？ 28Photo by somegeekintn http://www.ﬂickr.com/photos/66335021@N00/3219769312/
b= γ+ u0jLevel 2 (j) b= γ+ u1jLevel 1 (i) yij = b+ b1jx1ij + eij
Level 2 (j)切片 = 全体の切片の平均値 ( 固定効果 )     + 各学校特有の切片 ( 変量効果 ) 傾き = 全体の傾きの平均値 ( 固定効果 )     + 各学校特有の傾き ( 変量効果 ) Level 1 (i) y = 切片 + 傾き + 誤差 これまでの回帰分析と同じ
ようするに 31
レベル2 レベル1
ランダム切片とランダム係数• ランダム切片  ( random intercept ) • ランダム係数 ( random slope ) • ランダム切片&ランダム係数
• ランダム切片 切片がグループによって違う 傾きは同じ
• ランダム係数 ( 傾き )  傾きがグループによって違う 切片は同じ
• ランダム切片&ランダム係数 傾きも切片もグループによって違う
マルチレベルモデルの手順• レベル2を考慮した分析を行うべきか確認する。  ( 級内相関係数：ICC ) • 自由にモデルを組み立て、適合度 ( AIC、BIC ) を 比較し、最もフィットしているものを選ぶ。• 切片や係数の関係を見て、解釈を行う。•  ( 研究の目的に合わせて ) ランダム係数・切片を、 他のレベル2の特徴を示す変数で説明する。
適合度などはこちらを参照
マルチレベルモデルの前提• 回帰分析と同じ。• 独立性の仮定、回帰係数の等質性、	 球面性の仮定や分散等質性が満たさなくてもよい。
マルチレベルモデルの利点• カテゴリカルな変数も独立変数として扱える。• 正規分布以外の分布も扱える。• 自由なモデリング。• 欠損値があっても構わない。
イイネ！
適用例 42
ICC	 =	 .43
ランダム切片のみのモデルが 適合度が高い 44
変量効果  ( random	 eﬀects ) は 分散が推定される←ランダム切片の分散←誤差の分散←全体の切片←全体の係数 45
46
成長曲線モデル growth curve model個人の変化に興味がある。 47
これもマルチレベル 母集団として 想定する学習者全員 Level 2 学習者N 学習者A 学習者C学習者B  ( 学習者1名ずつ ) Time Time Level 1 Time Time Time Time Time Time Time Time Time Time 1 2  ( 3時点以上の繰り返し )  3 1 2 3 1 2 3 1 2 3 48
これと考え方は同じ 印南	 (49
50
51
52
ランダム切片のみのモデルが 適合度が高い 53
←ランダム切片の分散←誤差の分散←全体のTime1の平均←1回ごとに0.24点上がる 54
55
検定とモデリングの違い• 検定は「有意差あります」と言える。• モデリングは解釈が難しい。• 目的によって使いわけましょう。
・もっと使われるようになるでしょう。・理解するにはソフトを使いながら、 解釈の練習をする必要があります。
mizumot.com/lablog/hlm

# 参考
* [マルチレベルモデルのはなし](https://www.slideshare.net/AtsushiMizumoto/20121110censored)